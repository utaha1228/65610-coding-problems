from typing import List
import random  # for generating random `r`

q = (2 ** 67) - 1
n = 10
m = 20
s = [136525239469865021712, 138146514979163998923, 41780762499514054813, 80595720452531236909, 48810317605311974993, 64238149465018616518, 120250933917517996395, 68955489162057622758, 54869499637774367192, 139442203655814650431]
A = [[109249848227892063940, 113130275742749107144, 20082549351846432967, 112368395380008603541, 95322903236203909561, 114136252660969940943, 2942327914309352535, 4566123976877643859, 55524291279838002932, 73305368219785705410], [114599737870857336657, 82170848242074183263, 61600798475480129154, 142291749323285342383, 12415282995912766565, 121084845613853817404, 110220820068904923095, 32043816925518883581, 102335202894027373476, 16871954760311282400], [133291470478002605832, 55287018766215426955, 9792741354265536054, 27249496468392842306, 45348860668633708658, 9103032969715725408, 64986988296889936850, 70901469732333816151, 111381450482686839915, 38840396651475790399], [16893434742529337730, 114929480661411212439, 78934780384235715306, 115331221240242329682, 273147969919977982, 138888931540837556735, 85352653044567251157, 82031945515258837431, 136073251471379757544, 56368966724743535854], [21785551623519965337, 46448673955664197431, 107021054721800874764, 125721741038504264451, 17293730182797632267, 52857900162934947535, 26893317075682616608, 56693116540099062424, 39407286175286852235, 38840608107773354869], [84778599855769694712, 11651208622553435633, 143844168736019997884, 136703574437688234429, 128226514862373619738, 105327787185007699374, 21683191904203570512, 82800128140171801189, 101462876314808567397, 95061259328326975977], [89573537680952801719, 41367862575731878611, 11786730319679942528, 111426583931822748598, 80271912906493523346, 140748978435069208120, 135642533202324813689, 131014244205576213209, 124653410648922994668, 84777757745223581983], [46565381282341673323, 97316813035820386371, 15908543194206691639, 128155959431255040687, 84048283164472474992, 60987092789761768255, 21959230812289640304, 142948896218356883303, 147029358817662901667, 1764968472565738701], [23483364454483382267, 145929046522803430858, 105890948882364248763, 8078797033604389278, 145378083494659108235, 44035954638262987308, 124118272740431078703, 105232419162519568923, 133410612501560429226, 119076899984472235322], [115537088621388678752, 34313849759867225338, 82788082579914703847, 112490970522223394164, 84892519812556381606, 53506736243991133895, 61610372036181487515, 17681055206388282753, 86698171569480447741, 128930358920462723837], [56849475556360930836, 111322781598538316454, 70736924958744589917, 1381751426161445348, 12638943658034164389, 113773621809784588631, 95869624167489133616, 135326741038627357346, 127482648764299568333, 72835154791566176355], [64267278370783855116, 120839478206753920995, 43181607428996736090, 40259835128483877654, 57338799164596853725, 126136344895827166033, 34280272293560332991, 137882400792523060497, 95855333415052230229, 32357172023447295620], [40156144913628802302, 23997100059401258325, 112621180784133001472, 110492418022166608991, 26384173667795554443, 56667411518522202966, 36866630391930930180, 91470410231036716970, 90862436431210794389, 135635014863104994871], [79670711332859766313, 24524376345152464005, 59205391784752502215, 117796919775152347009, 112460214543092960850, 205050444833859075, 16763389673503340109, 65311980661868469224, 57295230819361576886, 99019770707195010089], [119569553159008986599, 146723723153760862925, 71509268138529099202, 124793819023121747682, 128980657581676492552, 24032912686627143072, 4894935643509996384, 6883084771492789809, 44487183941468290658, 21071986504681895476], [81527893106814141439, 12130425476586606300, 25485411385056755447, 110798869491178166193, 59809725460677949762, 107662620858377709415, 130498990119466942135, 32784720211554017905, 60562731787540707617, 58920837924549831040], [141998059413689761893, 86854319136750665017, 11260200117415592455, 98873075770273431886, 39483033467470093021, 57701922465831020297, 77050953966015566071, 82068252000683403607, 19579958163065175635, 88830458986616850328], [100691635540563398024, 88255835818370467388, 31940928090947433147, 34588442168429879747, 91725306570355047648, 109079552723512486506, 93501728293547854784, 52547281560827014158, 88411115533476930260, 62256738760954950690], [4775780027264988758, 32091307389977031720, 33235837675078639832, 123507779978709080563, 20631446219773409099, 45226335421720125438, 45800324762148621171, 63243111829273128860, 83627781224624974374, 108814531399163791778], [43368388659102926658, 66659517542739703803, 24659170276004441629, 62009116636822137165, 45205701432678368363, 131771555496646239115, 123867432176396618698, 51376224513501202404, 59542194138689288348, 84235001727988289929]]
u = [28446925881676134348, 42301273467639376234, 124006871475045267693, 7761373859864826205, 135059773712291711126, 20561783203247770150, 115976261485850362802, 4386174422579869224, 6819646130087207772, 124812471443431530085, 74700498793518955552, 120557306221715749815, 22748872484507882599, 43728432492897161230, 49803923491940821119, 28420269353218222119, 119604339938397962360, 35061487370486639637, 134307447590655868526, 111065825148395028206]

def enc(b: bool) -> List[int]:
	r = [random.randrange(0, 2) for _ in range(m)]
	ret = [0] * (n + 1)

	for i in range(m):
		for j in range(n):
			ret[j] = (ret[j] + r[i] * A[i][j]) % q

	for i in range(m):
		ret[-1] = (ret[-1] + u[i] * r[i]) % q

	if b:
		ret[-1] = (ret[-1] + q // 2) % q
	return ret

if __name__ == "__main__":
	# Some sanity checks. Make sure you can pass these before submit it.
	c = enc(0)
	c_ = enc(0)
	c1 = enc(1)
	assert c != c_
	assert isinstance(c, list)
	assert all(isinstance(x, int) for x in c)
	assert len(c) == n + 1

	z = [-x for x in s] + [1]
	print(hex(sum(c[i] * z[i] for i in range(n + 1)) % q))
	print(hex(sum(c1[i] * z[i] for i in range(n + 1)) % q))

	print("All good")